resources:
  - https://github.com/prometheus-operator/kube-prometheus.git?ref=v0.11.0
  - grafana-ingress.yaml
  - prom-ingress.yaml
  - prometheus-clusterrole.yaml
  - prometheus-clusterrolebinding.yaml
  - loki.yaml # generated from helm template grafana/loki
  - loki-ingress.yaml
  - promtail.yaml # generated from helm template grafana/promtail

# actually not that secret, so no need to seal it
secretGenerator:
  - name: grafana-datasources
    namespace: monitoring
    behavior: replace
    files:
      - grafana-datasources.yaml

patchesStrategicMerge:
  - patches/delete-ns-monitoring.yaml

# Temporary, waiting for server side apply in argocd 1.25
patches:
  - path: patches/prometheus-crd.yaml
    target:
      name: prometheuses.monitoring.coreos.com
      kind: CustomResourceDefinition
